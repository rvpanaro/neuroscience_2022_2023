<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Introduction to Statistics: R intro</title>
    <meta charset="utf-8" />
    <meta name="author" content="Prof. Dr. Tim Friede   Dr. Andreas Leha  Renato Valladares Panaro, MSc" />
    <script src="libs/header-attrs-2.17/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Introduction to Statistics: R intro
]
.subtitle[
## Neuroscience 2022-2023
]
.author[
### Prof. Dr. Tim Friede <br> Dr. Andreas Leha<br> Renato Valladares Panaro, MSc
]
.institute[
### <span style="font-size: 75%;">University Medical Center Göttingen<br> <a href='https://medstat.umg.eu/'>Department of Medical Statistics</a></span>
]
.date[
### <span style = 'font-size: 75%;'>October 2022&lt;/span’&gt;
]

---



# Download R and RStudio

--

## R Installation

-   Windows: go to &lt;https://cran.r-project.org/bin/windows/base/&gt; and
    download the .exe file and install it on your machine.

-   Macosx: go to &lt;https://cran.r-project.org/bin/macosx/&gt; and download
    the file according to the spec. of your machine.

-   Linux: go to &lt;https://cran.r-project.org/bin/linux/&gt; select your
    distribution and follow the instructions to install R and its
    dependencies.

--

## The manual 
- R language is defined in [https://cran.r-project.org/doc/manuals/r-release/R-lang.html](https://cran.r-project.org/doc/manuals/r-release/R-lang.html).

---

# Install RStudio 

 Go to &lt;https://www.rstudio.com/products/rstudio/download/#download&gt; and
download the installation file according to your operating system.

--

&lt;center&gt;
&lt;img src="./img/rstudioIDE.png" style="width: 95%" /&gt;
&lt;/center&gt;

---

# RStudio panels

--

&lt;center&gt;
&lt;img src="https://bookdown.org/ndphillips/YaRrr/images/RStudio_Screenshot_Labels.png" alt = "source: https://bookdown.org/ndphillips/YaRrr/images/RStudio_Screenshot_Labels.png"  style="width: 95%" /&gt;
&lt;/center&gt;
[https://bookdown.org/ndphillips/YaRrr/images/RStudio_Screenshot_Labels.png](https://bookdown.org/ndphillips/YaRrr/images/RStudio_Screenshot_Labels.png)

---

## Write an R script

.pull-left[
- Find the *File* tab and click *New File*.

&lt;center&gt;
&lt;img src="./img/Screenshot from 2022-09-20 23-33-30.png"  style="width: 100%" /&gt;
&lt;/center&gt;

- The **Untitled1** Rscript will appear in the source panel.


&lt;center&gt;
&lt;img src="./img/Screenshot from 2022-10-03 17-11-27.png"  style="width: 80%" /&gt;
&lt;/center&gt;

]

.pull-right[
- Run a line of code using the `ctrl+ENTER` shortcut.


- The output is retrieved in the console panel.
&lt;center&gt;
&lt;img src="./img/Screenshot from 2022-10-03 17-11-35.png"  style="width: 80%" /&gt;
&lt;/center&gt;

- The source code is written and then saved locally using the .R extension (e.g. **mycode.R**).
]

---

# Ask R!

Use the
 *help()* command with an object name inside
the parenthesis.


```r
help(sum)
```

&lt;center&gt;
&lt;img src="./img/Screenshot from 2022-09-20 15-13-19.png" style="width: 80%" /&gt;
&lt;/center&gt;

---

## Schedule

Cover the basics of sections 2 and 3 of the R-lang [manual](https://cran.r-project.org/doc/manuals/r-release/R-lang.html).

### Section 2 - Objects:

--

  - 1) Basic types
      - Vectors
      - Lists
      - Function objects
      - Environments
      - **NULL** 
--

  - 2) Attributes
      - Names 
      - Dimensions
      - Dimnames 
      - Classes 
 

---

## Schedule

--

  - 3) Special compound objects
      - Factors 
      - Data frame objects 

--

### Section 3 - Evaluation of expressions:

- 4) Simple evaluation
  - Function calls
  - Operators

--

- 5) Control structures
  - if
  - for
  - while

--

- 6) Indexing
  - Indexing by vectors
  - Indexing other structures
  
---

class: left, middle
background-color: #f0f0f0
background-size: cover

# 1) Basic types 

---


## Vectors 

&gt; R has six basic (‘atomic’) vector types: logical, integer, real, complex, string (or character) and raw. 

| typeof    | mode      | storage.mode | example |
|-----------|-----------|--------------|--------------|
| logical   | logical   | logical      | x = TRUE |
| double    | numeric   | double       | x = 1|
| character | character | character    | x = "1"|


```r
c(1,3,9)
```

```
## [1] 1 3 9
```


```r
typeof(c(1,3,9))
```

```
## [1] "double"
```

---


## Lists

&gt; Lists (‘generic vectors’) have elements, each of which can contain any type of R object, i.e. the elements of a list do not have to be of the same type.

&gt; Lists are vectors, and the basic vector types are referred to as atomic vectors where it is necessary to exclude lists. 

--

.pull-left[

```r
list(TRUE, 1L, 1, "1")
```

```
## [[1]]
## [1] TRUE
## 
## [[2]]
## [1] 1
## 
## [[3]]
## [1] 1
## 
## [[4]]
## [1] "1"
```
]

.pull-right[
&lt;center&gt;
&lt;img src="./img/list.png" style="width: 90%" /&gt;
&lt;/center&gt;
]

---

class: left, middle
background-color: #f0f0f0
background-size: cover

# 2) Attributes

---

## Names 

&gt; A names attribute, when present, labels the individual elements of a vector or list.

--


```r
z &lt;- 1:3
names(z)
```

```
## NULL
```

```r
names(z)[2] &lt;- "b" ## assign just one name
z
```

```
## &lt;NA&gt;    b &lt;NA&gt; 
##    1    2    3
```

```r
class(names(z))
```

```
## [1] "character"
```

---

## Dimensions

&gt; The dim attribute is used to implement arrays.

--


```r
x &lt;- 1:12 ## atomic vector
dim(x) &lt;- c(3, 4)
x
```

```
##      [,1] [,2] [,3] [,4]
## [1,]    1    4    7   10
## [2,]    2    5    8   11
## [3,]    3    6    9   12
```

--

Alternatively,


```r
x &lt;- matrix(1:12, ncol = 4, nrow = 4)
x
```

```
##      [,1] [,2] [,3] [,4]
## [1,]    1    5    9    1
## [2,]    2    6   10    2
## [3,]    3    7   11    3
## [4,]    4    8   12    4
```

---

## Dimnames 

&gt; Arrays may name each dimension separately using the dimnames attribute which is a list of character vectors.

--


```r
x &lt;- matrix(1:12, ncol = 4, nrow = 4)
dimnames(x) &lt;- list(c("A", "B", "C", "D"), as.character(1:4))
x
```

```
##   1 2  3 4
*## A 1 5  9 1
## B 2 6 10 2
## C 3 7 11 3
## D 4 8 12 4
```


```r
x["A", ]
```

```
## 1 2 3 4 
*## 1 5 9 1
```

---

## Classes 

&gt; R has an elaborate class system, principally controlled via the class attribute. 

--


```r
(x &lt;- 10)
```

```
## [1] 10
```

```r
(y &lt;- list(obj1 = x))
```

```
## $obj1
## [1] 10
```

--


```r
class(x)
```

```
## [1] "numeric"
```

```r
class(y)
```

```
## [1] "list"
```

---

class: left, middle
background-color: #f0f0f0
background-size: cover

# 3) Special compound objects

---

## Factors

&gt; Factors are used to describe items that can have a finite number of values (gender, social class, etc.). 

&gt; A factor may be purely nominal or may have ordered categories.

--


```r
(x &lt;- factor(x = c(3, 1, 2), labels = c("large", "small", "medium")))
```

```
## [1] medium large  small 
## Levels: large small medium
```

```r
levels(x) &lt;- c("small", "medium", "large")
```

--


```r
x
```

```
## [1] large  small  medium
## Levels: small medium large
```

---

## Data frame objects

&gt; A data frame is a list of vectors, factors, and/or matrices all having the same length (number of rows in the case of matrices).


```r
L3 &lt;- LETTERS[1:3]
fac &lt;- sample(L3, 4, replace = TRUE)
d &lt;- data.frame(x = 1L, y = 1:4, fac = fac)
```


```r
d
```

```
##   x y fac
*## 1 1 1   A
*## 2 1 2   C
## 3 1 3   B
## 4 1 4   A
```

--


```r
d[1:2, ]
```

```
##   x y fac
*## 1 1 1   A
*## 2 1 2   C
```

---

class: left, middle
background-color: #f0f0f0
background-size: cover

## 4) Simple evaluation

---

### Function calls

&gt; Most of the computations carried out in R involve the evaluation of functions. 

&gt; Functions are invoked by name with a list of arguments separated by commas. 

.pull-left[

```r
Speed &lt;- cars$speed
Distance &lt;- cars$dist


plot(
  x = Speed,
  y = Distance,
  pch = 0,
  cex = 1.2,
  col = "blue",
  bty = "n"
)
```
]

.pull-right[
&lt;img src="index_files/figure-html/unnamed-chunk-18-1.png" width="504" /&gt;
]

---

### Operators


```text
-	Minus, can be unary or binary
+	Plus, can be unary or binary
!	Unary not
~	Tilde, used for model formulae, can be either unary 
or binary
?	Help
:	Sequence, binary (in model formulae: interaction)
`*`	Multiplication, binary
/	Division, binary
^	Exponentiation, binary
&lt;	Less than, binary
&gt;	Greater than, binary
==	Equal to, binary
&gt;=	Greater than or equal to, binary
&lt;=	Less than or equal to, binary

[...]
```


```r
?operators
```
---

class: left, middle
background-color: #f0f0f0
background-size: cover

## 5) Control structures

---

### if

&gt; The if/else statement conditionally evaluates two statements. There is a condition which is evaluated and if the value is TRUE then the first statement is evaluated; otherwise the second statement will be evaluated. 


```r
x &lt;- -1
y &lt;- -1

if (x^2 + y^2 &lt; 1) {
  print(TRUE)
*} else {
* print(FALSE)
*} 
```

```
## [1] FALSE
```

---


### for

&gt; For each element in vector the variable *name* is set to the value of that element and *statement1* is evaluated.


```r
for (name in 1:3) {
* print(name + 1) # statement1
}
```

```
## [1] 2
## [1] 3
## [1] 4
```

&gt; A side effect is that the variable name still exists after the loop has concluded and it has the value of the last element of vector that the loop was evaluated for. 


---

class: left, middle
background-color: #f0f0f0
background-size: cover

## 6) Indexing

---

.pull-left[

### Indexing matrices and arrays

&gt; R allows some powerful constructions using vectors as indices. We shall discuss indexing of simple vectors first.


```r
(m &lt;- matrix(1:6, nrow = 2))
```

```
##      [,1] [,2] [,3]
## [1,]    1    3    5
## [2,]    2    4    6
```

```r
m[, 1:2]
```

```
##      [,1] [,2]
## [1,]    1    3
## [2,]    2    4
```

```r
m[2, ]
```

```
## [1] 2 4 6
```
]


.pull-right[

### Indexing other structures


```r
my_ls &lt;- list(
  obj1 = m,
  obj2 = "Hallo"
)

my_ls["obj1"]
```

```
## $obj1
##      [,1] [,2] [,3]
## [1,]    1    3    5
## [2,]    2    4    6
```

```r
my_ls[["obj1"]]
```

```
##      [,1] [,2] [,3]
## [1,]    1    3    5
## [2,]    2    4    6
```

```r
my_ls$obj2
```

```
## [1] "Hallo"
```
]

---

### Useful links 

- CRAN manuals: [https://cran.r-project.org/manuals.html](https://cran.r-project.org/manuals.html)


- RStudio manuals: [https://rstudio.github.io/r-manuals/r-intro/](https://rstudio.github.io/r-manuals/r-intro/)

- The Base R Cheat Sheet: [https://iqss.github.io/dss-workshops/R/Rintro/base-r-cheat-sheet.pdf](https://iqss.github.io/dss-workshops/R/Rintro/base-r-cheat-sheet.pdf)

### Help function

Search the help files for a word or phrase:

```r
help.search("weighted mean")
```

Find help for a package:


```r
help(package = "dplyr")
```

---

class: left, middle
background-color: #f0f0f0
background-size: cover

# Exercise 1 - Basic R 
## (20 min)
# Exercise 2 - Descriptive Statistics 
## (25 min)

---

# Exercise 1 - R basics

## Simple functions

Generate a vector of length 10 containing some numbers. Try what happens when you apply the *sort()*
function. Check its help pages to see what additional options you can specify. What do the related 
*rank()* and *order()* functions do?

--


```r
# generate some numbers:
x &lt;- c(7, 3, 12, 0:4, 100, -3)

print(x)

length(x)
```

--


```
##  [1]   7   3  12   0   1   2   3   4 100  -3
```

```
## [1] 10
```

---


```r
# sort():
?sort

sort(x)

sort(x, decreasing = TRUE)
```

--


```
##  [1]  -3   0   1   2   3   3   4   7  12 100
```

```
##  [1] 100  12   7   4   3   3   2   1   0  -3
```

--


```r
?NA

sort(c(5, 7, 1, NA, 3))

sort(c(5, 7, 1, NA, 3), na.last = TRUE)

sort(c(5, 7, 1, NA, 3), na.last = FALSE)
```

--


```
## [1] 1 3 5 7
```

```
## [1]  1  3  5  7 NA
```

```
## [1] NA  1  3  5  7
```

---


```r
# rank()

?rank

rank(x)

cbind(x, "rank()" = rank(x))

x
```

--


```
##  [1]  8.0  5.5  9.0  2.0  3.0  4.0  5.5  7.0 10.0  1.0
```

```
##         x rank()
##  [1,]   7    8.0
##  [2,]   3    5.5
##  [3,]  12    9.0
##  [4,]   0    2.0
##  [5,]   1    3.0
##  [6,]   2    4.0
##  [7,]   3    5.5
##  [8,]   4    7.0
##  [9,] 100   10.0
## [10,]  -3    1.0
```

```
##  [1]   7   3  12   0   1   2   3   4 100  -3
```

---

## Trigonometric functions

Use the *seq()* function to generate a vector *x* of length 100 of evenly spaced numbers between 0 and `\(2\pi\)`. Draw a plot (using *plot()*) of *x* vs. *sin(x)*. Use the *plot()* function's type argument to draw a connecting line. Use the *lines()* function to also add the cosine to the plot.

--

.pull-left[

```r
# trigonometric functions:
x &lt;- seq(
  from = 0,
  to = 2 * pi,
  length = 100
)

plot(x = x, y = sin(x))
```
]

--

.pull-right[
&lt;img src="index_files/figure-html/unnamed-chunk-31-1.png" width="504" /&gt;
]

---

.pull-left[

```r
plot(x, sin(x), type = "l")

?lines

# plot(x, cos(x))
lines(x, cos(x))
```
]

--

.pull-right[
&lt;img src="index_files/figure-html/unnamed-chunk-32-1.png" width="504" /&gt;
]

--

.pull-left[

```r
plot(x, sin(x),
  type = "l",
  col = "red", xlab = "x",
  ylab = "y",
  main = "Trigonometric functions"
)

lines(x, cos(x), col = "blue")
```
]

--

.pull-right[
&lt;img src="index_files/figure-html/unnamed-chunk-33-1.png" width="504" /&gt;
]

---

# Exercise 2 - Descriptive statistics
CASE STUDY: In a clinical trial 12 patients are randomly assigned to two different treatments. Blood
measurements are taken before and after the treatment.

## Loading data
Read the data (F:/neuroscience_ws2018/exercise_001/study1.csv) into the R workspace .

--


```r
dt &lt;- read.csv("data/study1.csv", sep=";")
str(dt)
```

--


```
## 'data.frame':	12 obs. of  4 variables:
##  $ patient: int  1 2 3 4 5 6 7 8 9 10 ...
##  $ group  : chr  "a" "a" "a" "a" ...
##  $ before : num  0.372 0.442 0.382 0.569 0.571 ...
##  $ after  : num  0.221 0.44 0.331 0.591 0.668 ...
```

---

## Summary statistics

Calculate mean, median, variance, standard deviation, quartiles and the sum of the measurements before treatment (*mean()*).

--


```r
c(sum = sum(dt$before), mean = mean(dt$before), median = median(dt$before)) 
```

--


```
##       sum      mean    median 
## 5.2126380 0.4343865 0.4119027
```

--


```r
c(var = var(dt$before), sd = sd(dt$before))
```

--


```
##        var         sd 
## 0.01246266 0.11163628
```

--


```r
quantile(dt$before, probs=c(0.25, 0.50, 0.75))
```

--


```
##       25%       50%       75% 
## 0.3638939 0.4119027 0.5452815
```

---

## Box Plot
Plot a boxplot and a histogram of the measurements before treatment. Correct title of axes. Choose
appropriate range of axes (*boxplot()*).

--

.pull-left[

```r
?boxplot
boxplot(dt$before)
```

&lt;img src="index_files/figure-html/unnamed-chunk-38-1.png" width="288" /&gt;
]

--

.pull-right[

```r
boxplot(dt$before, 
        dt$after, 
        horizontal = TRUE)
```

&lt;img src="index_files/figure-html/unnamed-chunk-39-1.png" width="288" /&gt;
]

---

.pull-left[

```r
boxplot(dt$before, 
        xlab = "Before treatment", 
        ylab = "Blood measurements", 
        ylim = c(0.2, 0.7), 
        main = "Box plot", 
        horizontal = TRUE)
points(dt$before, y = rep(0.6, 12), pch=1,
       col="orange", cex=0.75)
```
]

--

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-40-1.png" width="504" /&gt;
]

--

.pull-left[

```r
# Histogram
hist(dt$before, 
     xlim = c(0.2, 0.7), 
     xlab = "Before treatment", 
     main = "Histogram", 
     breaks = 12)
points(dt$before, rep(0, 12), pch=15, col="orange", cex=0.75)
```
]

--

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-41-1.png" width="504" /&gt;
]

---

## Bar Chart
Determine the absolute and relative frequencies of patients in the study groups. Plot a bar chart of the parameter "group" (*pie()* and *barplot()*).

--

.pull-left[

```r
## absolute
table(dt$group)
## relative
table(dt$group) / length(dt$group)
```
]

--

.pull-right[


```
## 
## a b 
## 6 6
```

```
## 
##   a   b 
## 0.5 0.5
```
]

--

.pull-left[


```r
pie(table(dt$group))
```

&lt;img src="index_files/figure-html/unnamed-chunk-43-1.png" width="216" /&gt;
]

--

.pull-right[

```r
barplot(table(dt$group))
```

&lt;img src="index_files/figure-html/unnamed-chunk-44-1.png" width="216" /&gt;
]
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="libs/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightLines": true,
"highlightStyle": "github",
"countIncrementalSlides": false,
"seal": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>
<style>
.logo {
  background-image: url(xaringan.png);
  background-size: contain;
  background-repeat: no-repeat;
  position: absolute;
  top: 1em;
  right: 1em;
  width: 200px;
  height: 26px;
  z-index: 0;
}
</style>

<script>
document
  .querySelectorAll(
    '.remark-slide-content' +
    ':not(.title-slide)' +
    // add additional classes to exclude here, e.g.
    // ':not(.inverse)' +
    ':not(.hide-logo)'
  )
  .forEach(el => {
    el.innerHTML += '<div class="logo"></div>';
  });
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
